<script setup lang="ts">
import { ref, watch } from "vue";
import { useGameStore } from "../gameLogic";
const gameStore = useGameStore();

const props = defineProps<{
  canvasRef: HTMLDivElement | undefined;
}>();

const foodRef = ref<HTMLDivElement>();

watch(
  () => props.canvasRef,
  (canvasRef) => {
    if (!!canvasRef) {
      gameStore.init("rat");
    }
    gameStore.$subscribe((mutation, state) => {
      if (gameStore.allInitialized && canvasRef && foodRef.value) {
        if (gameStore.foodPos) {
          foodRef.value.style.width = (1 / gameStore.boardWidth) * canvasRef.clientWidth + "px";
          foodRef.value.style.height = (1 / gameStore.boardHeight) * canvasRef.clientHeight + "px";
          foodRef.value.style.left =
            (gameStore.foodPos.x / gameStore.boardWidth) * canvasRef.clientWidth + "px";
          foodRef.value.style.top =
            (gameStore.foodPos.y / gameStore.boardHeight) * canvasRef.clientHeight + "px";
        }
      }
    });
  },
);
</script>

<template>
  <div class="rat" ref="foodRef">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 288.04 250.1">
      <path
        fill="#fff"
        d="M209.81,37.78c-2.34-2.04-4.47-3.71-6.39-5.59-3.46-3.38-4.67-7.68-4.33-12.38,.42-5.9,6-9.24,11.36-6.7,2.07,.98,3.84,2.63,5.64,4.11,1.39,1.14,2.48,2.65,3.92,3.7,3.72,2.71,7.85,3.11,11.64,.51,3.17-2.18,6.44-2.94,10.16-2.94,5.42,0,6.96-1.3,8.09-6.63,.45-2.11,.49-4.3,.73-6.45,.19-1.73,.4-3.47,.63-5.41,4.31,.18,5.15,3.14,5.8,5.81,.63,2.6,.61,5.36,.83,8.06,.07,.88,.01,1.78,.01,2.53,3.24,1.55,6.21,3.16,9.32,4.39,1.43,.56,3.18,.62,4.74,.47,2.87-.28,5.69-.95,8.55-1.33,4.24-.56,6.64,1.06,7.23,5.31,1.08,7.84-.68,15.01-5.66,21.31-2,2.53-3.67,5.34-5.83,7.72-2.16,2.38-4.56,4.64-7.19,6.48-4.87,3.41-10.26,6.12-14.94,9.76-6.57,5.11-12.74,10.73-14.05,19.74-.47,3.21-1.49,6.34-1.86,9.56-.29,2.47-.37,5.11,.18,7.5,1.13,4.83,5.46,6.88,10.08,5.15,.84-.31,1.57-.91,2.41-1.22,4.19-1.51,8.17,.38,9.39,4.69,.68,2.42,.97,4.96,1.22,7.47,.39,3.99-1.54,6.79-4.98,9.06-3.42-2.68-6.72-5.19-7.53-10.02-.37,.18-.74,.35-1.11,.53-.97,2.57-1.94,5.14-2.91,7.72-5.04-.57-8.28-3.08-10.61-7.34-1.31,.43-2.55,.61-3.54,1.21-5.05,3.06-5.02,3.1-9.27-1.36-.37-.39-.75-.78-1.18-1.11-.28-.21-.65-.29-1.16-.51-6.37,3.3-12.19,7.29-15.76,14-2.15,4.04-5.36,7.25-9.19,9.79-5.1,3.39-7.37,8.19-7.34,14.25,0,1.78-.47,3.55-.68,5.33-.23,1.95-.7,3.93-.56,5.86,.49,6.64-.39,12.96-3.5,18.91-.41,.79-.73,1.65-.97,2.52-1.16,4.22,.26,6.36,4.6,6.39,4.87,.03,9.78-.03,14.62-.52,5.37-.54,10.7-1.5,16.01-2.49,3.87-.72,7.46-.75,10.9,1.6,1.61,1.1,3.6,1.64,5.38,2.51,1.66,.81,3.11,1.85,2.98,4.42-4.24,.55-8.43,1.31-12.64,1.58-5.03,.32-10.09,.09-15.12,.34-9.37,.47-18.72,1.17-28.09,1.65-1.52,.08-3.23-.16-4.59-.81-1.98-.95-3.95-1.36-6.56-1.79,2.22,3.82,7.77,4.31,7.17,9.85-2.82,.54-5.67,.32-8.58-.15-5.7-.91-11.42-1.68-17.12-2.55-8.44-1.29-16.88-1.08-25.35-.24-1.73,.17-3.54-.27-5.29-.54-1.59-.24-3.15-.89-4.73-.9-3.46-.02-6.29-.83-8.34-3.96-.66-1.01-2.41-1.79-3.68-1.81-3.58-.06-7.31-.22-10.72,.66-6.16,1.58-12.33,2.68-18.68,2.82-9.57,.2-19.14,.28-28.71,.64-5.76,.22-11.5,.85-17.25,1.32-.72,.06-1.44,.18-2.13,.39-10.22,2.97-10.07,10.15-5.38,16.58,4.23,5.81,10.54,8.68,17.35,10.3,3.14,.75,6.42,1,9.65,1.17,17.22,.91,34.24-.93,51.18-3.93,10.48-1.86,20.94-3.81,31.47-5.35,4.07-.6,8.33-.62,12.42-.16,10.29,1.15,17.73,6.63,22.32,15.93,.7,1.42,1.35,2.86,1.41,4.87-1.1-.98-2.27-1.89-3.3-2.94-9.05-9.24-20.07-11.65-32.37-9.13-11.31,2.32-22.55,4.96-33.83,7.41-16.69,3.62-33.57,5.02-50.6,3.75-9.76-.73-19.27-2.85-28.09-7.39-5.04-2.59-9.49-5.89-13.01-10.4-7.52-9.65-5.38-22.27,5.21-28.36,3.53-2.03,7.59-3.51,11.59-4.26,6.54-1.22,13.22-1.82,19.86-2.36,10.43-.84,20.89-1.25,31.32-2.14,7.79-.66,15.24-2.79,22.24-6.39,7.08-3.65,10.05-9.75,8.38-17.49-6.07-28.05-2.34-54.91,10.13-80.58,6.64-13.67,16.37-24.58,30.16-31.53,6.7-3.38,13.85-5.15,21.25-5.97,4.48-.5,9.07-.38,13.48-1.22,5.82-1.12,11.56-2.75,17.24-4.47,3.26-.99,6.38-2.51,9.5-3.93,2.11-.96,4.28-1.99,5.01-4.91Z"
      />
    </svg>
  </div>
</template>

<style scoped lang="scss">
.rat {
  position: absolute;
}
</style>
